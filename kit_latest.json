{"code":"/** Handle the user message.\n * @param {string} payload the message sent by user\n * @param {AppState} state the state of the app\n * @param {Tool} tools available tools to perform a task\n */\nconst db = '{ \"news\" : [' +\n'{ \"summary\":\"Donald Trump just couldn t wish all Americans a Happy New Year and leave it at that. Instead, he had to give a shout out to his enemies, haters and  the very dishonest fake news media.  The former reality show star had just one job to do and he couldn t do it. As our Country rapidly grows stronger and smarter, I want to wish all of my friends, supporters, enemies, haters, and even the very dishonest Fake News Media, a Happy and Healthy New Year,  President Angry Pants tweeted.  2018 will be a great year for America! As our Country rapidly grows stronger and smarter, I want to wish all of my friends, supporters, enemies, haters, and even the very dishonest Fake News Media, a Happy and Healthy New Year. 2018 will be a great year for America!  Donald J. Trump (@realDonaldTrump) December 31, 2017Trump s tweet went down about as welll as you d expect.What kind of president sends a New Year s greeting like this despicable, petty, infantile gibberish? Only Trump! His lack of decency won t even allow him to rise above the gutter long enough to wish the American citizens a happy new year!  Bishop Talbert Swan (@TalbertSwan) December 31, 2017no one likes you  Calvin (@calvinstowell) December 31, 2017Your impeachment would make 2018 a great year for America, but I ll also accept regaining control of Congress.  Miranda Yaver (@mirandayaver) December 31, 2017Do you hear yourself talk? When you have to include that many people that hate you you have to wonder? Why do the they all hate me?  Alan Sandoval (@AlanSandoval13) December 31, 2017Who uses the word Haters in a New Years wish??  Marlene (@marlene399) December 31, 2017You can t just say happy new year?  Koren pollitt (@Korencarpenter) December 31, 2017Here s Trump s New Year s Eve tweet from 2016.Happy New Year to all, including to my many enemies and those who have fought me and lost so badly they just don t know what to do. Love!  Donald J. Trump (@realDonaldTrump) December 31, 2016This is nothing new for Trump. He s been doing this for years.Trump has directed messages to his  enemies  and  haters  for New Year s, Easter, Thanksgiving, and the anniversary of 9/11. pic.twitter.com/4FPAe2KypA  Daniel Dale (@ddale8) December 31, 2017Trump s holiday tweets are clearly not presidential.How long did he work at Hallmark before becoming President?  Steven Goodine (@SGoodine) December 31, 2017He s always been like this . . . the only difference is that in the last few years, his filter has been breaking down.  Roy Schulze (@thbthttt) December 31, 2017Who, apart from a teenager uses the term haters?  Wendy (@WendyWhistles) December 31, 2017he s a fucking 5 year old  Who Knows (@rainyday80) December 31, 2017So, to all the people who voted for this a hole thinking he would change once he got into power, you were wrong! 70-year-old men don t change and now he s a year older.Photo by Andrew Burton/Getty Images.\" , \"istrue\":false },' +\n'{ \"summary\":\"21st Century Wire says The CIA is trying its best to avoid oversight and accountability.Watch a video of this report here: An anonymous ex-CIA officer explains: The classic use of an eyewash is if you have a garden-variety source and all of a sudden he gains access to truly sensitive information, What you might do is have a false communication saying the guy got hit by a bus and died. The large number of people aware of this source suddenly think he is dead. But the continuing reporting on that source and from that source gets put into a very closed compartment that few would know about. In one documented example, CIA officials said that a senior Al-Qaeda member was killed as a result of tribal violence. Yet, in actual fact, the terrorist had been killed by a drone strike.The intent behind this eyewash was to conceal the then-secret CIA drone program in Pakistan.Former CIA inspector general, Fred Hitz, said that deliberately misleading employees is really playing with fire. Steven Aftergood, a government secrecy expert at the Federation of American Scientists, said, When you introduce falsehoods into the communications stream then you can destabilize the whole system of intelligence oversight and compliance with the law. What now needs to be examined is the extent to which this practice still takes places today and who exactly receives the accurate information. Is the true information ever sent to elected officials, or always withheld by this shadow government operating essentially on its own?Interestingly, it is often said by skeptics that any part of the government could never be involved in a monumental conspiracy because too many people would have to know about it, and someone would talk.The exposure of the eyewashing program now crushes this argument, as it reveals to us the extreme extent of compartmentalisation that exists within the modern American government that is capable of hiding the most despicable activities.It is also likely that many other government agencies employ similar tactics, in order to ensure that those at the top stay there and threats to their power can be dealt with quietly. Departments look out for themselves, and particularly their own relevance.Naturally, this intelligence phenomenon extends into the media, as mainstream media outlets always rely on their internal agency  sources  for any  inside information    which could  misleading, or completely false.What might they do, and subsequently try to hide, to ensure they stay relevant?READ MORE ON THE CLANDESTINE CIA: 21st Century Wire CIA Files\" , \"istrue\":false },' +\n'{ \"summary\":\"21st Century Wire says This week, the historic international Iranian Nuclear Deal was punctuated by a two-way prisoner swap between Washington and Tehran, but it didn t end quite the way everyone expected. On the Iranian side, one of the U.S. citizens who was detained in Iran, Nosratollah Khosravi-Roodsari, has stayed in Iran, but on the U.S. side   all 7 of the Iranians held in U.S. prisons DID NOT show up to their flight to Geneva for the prisoner exchange   with at least 3 electing to stay in the U.S  TEHRAN SIDE: In Iran, 5 U.S. prisoners were released, with 4 of them making their way to Germany via Switzerland.Will Robinson Daily MailNone of the Iranians freed in the prisoner swap have returned home and could still be in the United States, it has been reported.The seven former inmates, who were released as part of a deal with the Islamic republic, did not show up to get a flight to Geneva, Switzerland, where the exchange was set to take place on Sunday.Three of the Iranians have decided to stay in the United States, ABC reported, with some moving in with their families. However it is not known where the other four are.Three of the Americans who had been detained in Iran   Washington Post journalist Jason Rezaian, former U.S. Marine Amir Hekmati and Christian pastor Saeed Abedini   left Tehran at around 7am the same day, but weren t met by their counterparts in Switzerland Continue this story at the Mail OnlineREAD MORE IRAN NEWS AT: 21st Century Wire Iran Files\" , \"istrue\":false } ]}';\nconst obj = JSON.parse(db);\n\nfunction getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nasync function run(payload, state, tools) {\n  try{\n    if (!state.started){\n      state.question = true;\n      state.started = true;\n      const {yes} = JSON.parse(\n        await tools.yesOrNo(\n          {question: q1,\n          answer: payload}\n        )\n      );\n      if (!yes) {\n        tools.reply('Understood, the game has ended now. Goodbye!');\n        return;\n      }\n    }\n    if (state.question) {\n    state.question = false;\n    tools.reply(\"Please wait, I'm pulling a post.\")\n    // retrieve from db\n    let i = getRandomInt(0, obj.news.length-1);\n    let news = obj.news[i].summary;\n\n    state.text = await tools.repeatNews({info: news});\n    state.truth = obj.news[i].istrue;\n    tools.reply(state.text);\n    tools.reply(\"Is this piece of news true or false?\");\n    state.rounds++;\n    }\n    else {\n      await tof(payload, state, tools);\n      state.replay = true;\n    }\n\n    if (state.replay) {\n      tools.reply(`Your score is ${state.score} out of ${state.rounds}. Let's play again.`);\n      state.replay = false;\n      state.question = true;\n    }\n  }\n  catch (e) {\n    tools.reply(`There's something wrong with the code. The program will thus terminate. ${e}`);\n  }\n}\n\nasync function tof(payload, state, tools) {\n  let { userTruth } = JSON.parse(\n    await tools.trueOrFalse(\n      {\n        question: \"Is this piece of news true or false?\",\n        answer: payload\n      }\n      )\n    );\n\n  if (state.textTruth == userTruth) \n    {\n      state.score++;\n      tools.reply(`You're correct! This news is ${state.textTruth}. Here's how you can identify why:`); \n      \n    }\n  else {\n      tools.reply(`You're wrong! This news is ${state.textTruth}. Here's how you can identify why:`);\n    }\n  tools.reply(await tools.explanation({news: state.text, truth: state.textTruth.toString()}));\n}\n\n/** Startup.\n * @param {AppState} state the state of the app\n * @param {Tool} tools available tools to perform a task\n */\nasync function startup(state, tools) {\n  q1= \"I'm designed to test your social media savviness by giving you both fake and real news. Your task is to identify which is fake, and which is real. Are you ready for the challenge?\"\n  tools.reply(q1);\n  state.started = false;\n  state.question = false;\n  state.replay = false;\n  state.score = 0;\n  state.rounds = 0;\n  state.text = '';\n  state.textTruth = false;\n  state.userAnswer = false;\n}","llmFunctions":[{"functionName":"yesOrNo","description":"Detect if the answer is yes or no for the question.\n\nFrom this example, you will learn about how you can detect the users' intent from their message. Sometimes it's not as easy as passing the bot the question and the answer and let it guess, you also need to instruct it to think to improve the result.\n\nThis is not the only prompt that works, please feel free to try other prompts and see if you can get better results.\n\nYou can start with making it to only return yes or no to save some tokens.","arguments":["question","answer"],"enableMemory":false,"messageHistory":["memoryPlaceholder",{"role":"system","content":"Your job is to check if the answer is considered yes or no for the question. \nThe answer may not directly answer the question, you have to think, and answer as much as you can. \nIf you still can't determine, just treat it as no. \nReply with the format below in JSON: ###\n{\n  \"reason\": \"\",  // a string describing why you think it's true or false\n  \"yes\": tru, // or false\n}\n###"},{"role":"user","content":"Question: {{question}}\nAnswer: {{answer}}"}],"stream":false,"parameters":{"maxResponse":100,"temperature":0,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0}},{"functionName":"parseNumber","description":"Parse a number from the users' message. You can provide a hint for the bot to better understant the context\n\nWhat happens if you don't tell the bot that the number can be presented in different ways? Give it a try!\n","arguments":["message","hint"],"enableMemory":false,"messageHistory":["memoryPlaceholder",{"role":"system","content":"Your job is to detect a number from the message. \nThe number may be represented in different ways:\n- Arabic numerals.\n- word or character in different languages.\n- adjectives or nouns that reflect a number with given hint, for example, if the hint says the total number is 100, the message \"half\" implies 50.\n\nyou have to think, and answer as good as you can. If you still can't determine, just treat it as 0.\n\nReply with the format below in JSON: ###\n{\n  \"reason\": \"\",  // a string describing why you choose the number\n  \"number\": 0 // Arabic numerals detected\n}\n###"},{"role":"user","content":"Hint: {{hint}}\nMessage: {{message}}"}],"stream":false,"parameters":{"maxResponse":200,"temperature":0,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0}},{"functionName":"translateToLocale","description":"Translate a message to the locale language.","arguments":["message","locale"],"enableMemory":false,"messageHistory":["memoryPlaceholder",{"role":"system","content":"You are a translator. Your job is to translate the message to the locale language. The reply should only contain the translated content."},{"role":"user","content":"Locale: {{locale}}\nMessage: {{message}}"}],"stream":false,"parameters":{"maxResponse":500,"temperature":0.7,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0}},{"functionName":"fakePost","description":"Creates a fake news post intended to spread disinformation","arguments":["userMessage"],"enableMemory":true,"messageHistory":["memoryPlaceholder",{"role":"system","content":"Memorise how many times the user has guessed correctly, by referring to the chat history. Reply with the number of correct guesses by the user. Include a short list of methods that one can use to differentiate your fake news from real news"},{"role":"user","content":"{{userMessage}}"},{"role":"system","content":"Your job is to test this user's social media savviness by creating a summary of a piece of news, along with a source, title, and date written. Do not give any commentary. Keep your reply below 150 words."}],"stream":false,"parameters":{"maxResponse":150,"temperature":0.5,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0},"functions":[]},{"functionName":"trueOrFalse","description":"Detect if the user's answer is true or false for the given question.","arguments":["answer"],"enableMemory":false,"messageHistory":["memoryPlaceholder",{"role":"system","content":"The user is answering a true/false question.\nYour job is to check if user's answer is \"true\" or \"false\".\nThe answer may not directly answer the question, you have to think, and answer as much as you can. \nIf you can't determine, just treat it as false. \nReply with the format below in JSON: ###\n{\n  \"reason\": \"\",  // a string describing why you think it's true or false\n  \"userTruth\": true, // or false\n}\n###"},{"role":"user","content":"Answer: {{answer}}"}],"stream":false,"parameters":{"maxResponse":200,"temperature":0.9,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0},"functions":[]},{"functionName":"explanation","description":"Explains why a given piece of news is true or false, and shows the user how they can better differentiate fake from real.","arguments":["news","truth"],"enableMemory":false,"messageHistory":["memoryPlaceholder",{"role":"system","content":"You are given a piece of news, and also the truth value of the news, i.e. whether it is true or false\nYour job is to analyse the given piece of news and and reply with a numbered list of ways the user can deduce on first glance that the post is true or false, giving your reasoning. Give the three main points."},{"role":"user","content":"News: {{news}}\nTruth: {{truth}}"}],"stream":false,"parameters":{"maxResponse":200,"temperature":0.7,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0},"functions":[]},{"functionName":"repeatNews","description":"repeat exactly a piece of news, but correcting grammar, punctuation and removing image captions.","arguments":["info"],"enableMemory":false,"messageHistory":["memoryPlaceholder",{"role":"system","content":"repeat exactly a piece of news, but correcting grammar, punctuation and removing image captions."},{"role":"user","content":"Info: {{info}}"}],"stream":false,"parameters":{"maxResponse":100,"temperature":0.7,"topP":0.95,"frequencyPenalty":0,"presencePenalty":0},"functions":[]}]}